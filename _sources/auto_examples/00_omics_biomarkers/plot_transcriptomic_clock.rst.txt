
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/00_omics_biomarkers/plot_transcriptomic_clock.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_00_omics_biomarkers_plot_transcriptomic_clock.py>`
        to download the full example code or to run this example in your browser via Binder

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_00_omics_biomarkers_plot_transcriptomic_clock.py:


"Transcriptomic Clock" using GEO Data
=============================================================

This example loads transcriptomic data from GEO, calculates the predicted age using a transcriptomic clock, and plots it against chronological age. 

.. GENERATED FROM PYTHON SOURCE LINES 9-11

First load up some transcriptomic data from GEO using the data library
---------------------------------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 11-16

.. code-block:: Python

    from biolearn.data_library import DataLibrary

    data = DataLibrary().get("GSE134080").load()









.. GENERATED FROM PYTHON SOURCE LINES 17-19

Now run the transcriptomic clock to predict age
------------------------------------------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 19-26

.. code-block:: Python


    from biolearn.model_gallery import ModelGallery

    rna_model = ModelGallery().get("TranscriptomicPredictionModel", imputation_method="none")
    predicted =  rna_model.predict(data)









.. GENERATED FROM PYTHON SOURCE LINES 27-29

Plot the results against the chronological age using seaborn
--------------------------------------------------------------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 29-45

.. code-block:: Python

    import matplotlib.pyplot as plt
    import seaborn as sns
    from scipy.stats import pearsonr

    predicted_values = predicted['Predicted']
    true_values = data.metadata['age']

    correlation, _ = pearsonr(true_values, predicted_values)
    print(f"Pearson Correlation Coefficient: {correlation}")

    sns.set_theme(style="whitegrid")
    sns.regplot(x=true_values, y=predicted_values, scatter_kws={'alpha':0.5})
    plt.title('Transcriptomic Prediction Model')
    plt.xlabel('Chronological Age')
    plt.ylabel('Transcriptomic Age')
    plt.show()



.. image-sg:: /auto_examples/00_omics_biomarkers/images/sphx_glr_plot_transcriptomic_clock_001.png
   :alt: Transcriptomic Prediction Model
   :srcset: /auto_examples/00_omics_biomarkers/images/sphx_glr_plot_transcriptomic_clock_001.png
   :class: sphx-glr-single-img


.. rst-class:: sphx-glr-script-out

 .. code-block:: none

    Pearson Correlation Coefficient: 0.7025211774998293





.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 1.515 seconds)

**Estimated memory usage:**  408 MB


.. _sphx_glr_download_auto_examples_00_omics_biomarkers_plot_transcriptomic_clock.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: binder-badge

      .. image:: images/binder_badge_logo.svg
        :target: https://mybinder.org/v2/gh/bio-learn/biolearn/main?urlpath=lab/tree/notebooks/auto_examples/00_omics_biomarkers/plot_transcriptomic_clock.ipynb
        :alt: Launch binder
        :width: 150 px

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_transcriptomic_clock.ipynb <plot_transcriptomic_clock.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_transcriptomic_clock.py <plot_transcriptomic_clock.py>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
